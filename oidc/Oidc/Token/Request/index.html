<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Request (oidc.Oidc.Token.Request)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">oidc</a> &#x00BB; <a href="../../index.html">Oidc</a> &#x00BB; <a href="../index.html">Token</a> &#x00BB; Request</nav><header class="odoc-preamble"><h1>Module <code><span>Token.Request</span></code></h1><p>Types and functions to work with the token endpoint</p></header><nav class="odoc-toc"><ul><li><a href="#notes">Notes</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = </span><span>{</span></code><table><tr id="type-t.grant_type" class="anchored"><td class="def record field"><a href="#type-t.grant_type" class="anchor"></a><code><span>grant_type : string;</span></code></td></tr><tr id="type-t.scope" class="anchored"><td class="def record field"><a href="#type-t.scope" class="anchor"></a><code><span>scope : <span>string list</span>;</span></code></td></tr><tr id="type-t.code" class="anchored"><td class="def record field"><a href="#type-t.code" class="anchor"></a><code><span>code : string;</span></code></td></tr><tr id="type-t.client_id" class="anchored"><td class="def record field"><a href="#type-t.client_id" class="anchor"></a><code><span>client_id : string;</span></code></td></tr><tr id="type-t.client_secret" class="anchored"><td class="def record field"><a href="#type-t.client_secret" class="anchor"></a><code><span>client_secret : <span>string option</span>;</span></code></td></tr><tr id="type-t.redirect_uri" class="anchored"><td class="def record field"><a href="#type-t.redirect_uri" class="anchor"></a><code><span>redirect_uri : <span class="xref-unresolved">Uri</span>.t;</span></code></td></tr></table><code><span>}</span></code></div><div class="spec-doc"><p>A token request</p></div></div><div class="odoc-spec"><div class="spec value" id="val-make" class="anchored"><a href="#val-make" class="anchor"></a><code><span><span class="keyword">val</span> make : 
  <span>client:<a href="../../Client/index.html#type-t">Client.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>grant_type:string <span class="arrow">&#45;&gt;</span></span>
  <span>scope:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>redirect_uri:<span class="xref-unresolved">Uri</span>.t <span class="arrow">&#45;&gt;</span></span>
  <span>code:string <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-to_body_string" class="anchored"><a href="#val-to_body_string" class="anchor"></a><code><span><span class="keyword">val</span> to_body_string : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Creates the body for the token request</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_body_string" class="anchored"><a href="#val-of_body_string" class="anchor"></a><code><span><span class="keyword">val</span> of_body_string : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>( <a href="#type-t">t</a>, <span>[&gt; <span>`Msg of string</span> ]</span> )</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div><div class="spec-doc"><p>Parses a request body into a t</p></div></div><h3 id="notes"><a href="#notes" class="anchor"></a>Notes</h3><p>The Authorization Server MUST validate the Token Request as follows:</p><ul><li>Authenticate the Client if it was issued Client Credentials or if it uses another Client Authentication method, per Section 9.</li><li>Ensure the Authorization Code was issued to the authenticated Client.</li><li>Verify that the Authorization Code is valid.</li><li>If possible, verify that the Authorization Code has not been previously used.</li><li>Ensure that the redirect_uri parameter value is identical to the redirect_uri parameter value that was included in the initial Authorization Request. If the redirect_uri parameter value is not present when there is only one registered redirect_uri value, the Authorization Server MAY return an error (since the Client should have included the parameter) or MAY proceed without an error (since OAuth 2.0 permits the parameter to be omitted in this case).</li><li>Verify that the Authorization Code used was issued in response to an OpenID Connect Authentication Request (so that an ID Token will be returned from the Token Endpoint).</li></ul></div></body></html>